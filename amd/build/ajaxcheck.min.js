define(["jquery","core/ajax","core/notification","core/event"],function(a,b,c,d){var e,f=function(){return a("div.que input.submit")},g=function(b){return a("div#q"+b+" div.outcome")},h=function(b){return a("div#q"+b)},i=function(b){for(var c=0;c<b.questions.length;c++){var e=b.questions[c];h(e.slot).replaceWith(e.html),d.notifyFilterContentUpdated(a(h(e.slot))),g(e.slot).hide().slideDown("slow"),a("body").css("cursor","default")}f().click(k)},j=function(b){a("#mod_quiz_navblock div.content").html(b.navigationpanelhtml)},k=function(d){if(""!=d.target.name){d.preventDefault();var f=a(this.form).serializeArray();f.push({name:d.target.name,value:d.target.value}),a("body").css("cursor","progress"),a(d.target).prop("disabled","disabled"),a(d.target).prop("value",e);for(var g=null,h=null,k=0;k<f.length;k++)"thispage"==f[k].name?h=f[k].value:"attempt"==f[k].name&&(g=f[k].value);var l=b.call([{methodname:"quizaccess_ajaxcheck_process_attempt",args:{attemptid:g,data:f}},{methodname:"quizaccess_ajaxcheck_get_attempt_data",args:{attemptid:g,page:h}},{methodname:"quizaccess_ajaxcheck_get_navigation_panel_html",args:{attemptid:g,page:h}}]);l[0].fail(c.exception),l[1].done(i).fail(c.exception),l[2].done(j).fail(c.exception)}},l=function(a){e=a,f().click(k)};return{setup:l}});