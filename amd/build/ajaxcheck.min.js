define(["jquery","core/ajax","core/notification","core/event","core/yui"],function(a,b,c,d,e){var f,g,h=function(){return a("div.que input.submit")},i=function(b){return a("div#q"+b+" div.outcome")},j=function(b){return a("div#q"+b)},k=function(b){j(b.slot).replaceWith(b.html),d.notifyFilterContentUpdated(a(j(b.slot))),i(b.slot).hide().slideDown("slow"),a("body").css("cursor","default"),o();for(var c=0;c<b.sequencechecks.length;c++){var e=b.sequencechecks[c].sequencecheck,f=b.sequencechecks[c].fieldprefix,g=a('input[name="'+f+':sequencecheck"]');g.addClass("ignoredirty"),g.val(e)}},l=function(b){a("#mod_quiz_navblock div.content").html(b.navigationpanelhtml)},m=function(d){if(""!=d.target.name){d.preventDefault();var g=a(this.form).serializeArray();g.push({name:d.target.name,value:d.target.value}),a("body").css("cursor","progress"),a(d.target).prop("disabled","disabled"),a(d.target).prop("value",f);for(var h=null,i=null,j=0;j<g.length;j++)"thispage"==g[j].name?i=g[j].value:"attempt"==g[j].name&&(h=g[j].value);var m=Number(a(d.target).closest("div.que").attr("id").substring(1)),n=b.call([{methodname:"quizaccess_ajaxcheck_process_attempt",args:{attemptid:h,data:g}},{methodname:"quizaccess_ajaxcheck_get_question_html",args:{attemptid:h,page:i,submitbuttonslot:m}},{methodname:"quizaccess_ajaxcheck_get_navigation_panel_html",args:{attemptid:h,page:i}}]);n[0].fail(c.exception),n[1].done(k).fail(c.exception),n[2].done(l).fail(c.exception),e.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()})}},n=function(b){var c=a(b).attr("class").split(" ")[1];return a.inArray(c,g)!==-1},o=function(){h().each(function(){n(a(this).closest("div.que"))&&(a(this).click(m),a(this).addClass("ignoredirty"))})},p=function(a,b){f=a,g=b,o()};return{setup:p}});